<div class="modal fade" id="hero-join-game-modal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-body">
          <div class="img">
              <img src="" class="image-hero" >
          </div>
          <div class="description">
              <h4 class="quality">Quality: Common</h4>
              <p class="f-inter">Set this NFT to your Avatar to display and make it eligible for more benefits in the Pixil Saga</p>
          </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-primary btn-approve">Approve</button>
        <button type="button" class="btn btn-primary btn-set-avatar" style = "display: none;">Set your Avatar</button>
      </div>
    </div>
  </div>
</div>

<script>

  var heroId = null;
  var setHeroJoinGameId = null;
  var user = null;
  $("#hero-join-game-modal").on("show.bs.modal",async function(event)
  {
    var tokenId = $(event.relatedTarget).data('heroid');
    heroId = tokenId ? parseInt(tokenId) : heroId;
    // render info
    let teamId = await PixilSaga.HeroNFT.getTeamIdByHeroId(heroId);
    renderInfoHero(teamId);
    // check approve GameController
    checkApproveToGameController (heroId);
  });
  $(".btn-approve").click(function () {
    approve(heroId);
  });
  $(".btn-set-avatar").click(async function () {
    LetHeroNFTJoinToGame(heroId);
  });
  function renderInfoHero (teamId) 
  {
    $('.image-hero').attr('src', `../assets/images/Hero_Team_Id_${teamId}.png`);
  }

  async function checkApproveToGameController (heroId)
  {
    let to = PixilSaga.GameController.configs.Contract.GetGameControllerContract();
    let resultCheckApprove = await PixilSaga.HeroNFT.getApproved (heroId);
    if (to == resultCheckApprove) {
      $(".btn-approve").hide();
      $(".btn-set-avatar").show();
    }
    else {
      $(".btn-approve").show();
      $(".btn-set-avatar").hide();
    }
  }
  function approve(heroId)
  {
    let to = PixilSaga.GameController.configs.Contract.GetGameControllerContract();
    PixilSaga.HeroNFT.approve(to, heroId);
  }

  function LetHeroNFTJoinToGame(heroId)
  {
    PixilSaga.GameController.LetHeroNFTJoinToGame(heroId);
  }
</script>

