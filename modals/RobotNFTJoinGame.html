<div class="modal fade" id="robot-join-game-modal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-body">
          <div class="img">
              <img src="" class="image-robot-level" >
          </div>
          <div class="description">
              <h4 class="quality">Quality: Common</h4>
              <p class="f-inter">Set this NFT to your Avatar to display and make it eligible for more benefits in the Pixil Saga</p>
          </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-primary btn-approve">Approve</button>
        <button type="button" class="btn btn-primary btn-set-in-game" style = "display: none;">Set Robot to Ingame</button>
      </div>
    </div>
  </div>
</div>

<script>

  var robotId = null;
  var setRobotJoinGameId = null;
  var user = null;
  $("#robot-join-game-modal").on("show.bs.modal",async function(event)
  {
    var tokenId = $(event.relatedTarget).data('robotid');
    robotId = tokenId ? parseInt(tokenId) : robotId;
    // render info
    let infoRobot = await PixilSaga.RobotNFT.getInfoRobotByRobotId(robotId);
    renderInfoRobot(infoRobot.level);
    // check approve GameController
    checkApproveToGameController (robotId);
  });
  $(".btn-approve").click(function () {
    approve(robotId);
  });
  $(".btn-set-in-game").click(async function () {
    LetRobotNFTJoinToGame(robotId);
  });
  function renderInfoRobot (level) 
  {
    $('.image-robot-level').attr('src', `../assets/images/Robot_level_Id_${level}.png`);
  }

  async function checkApproveToGameController (robotId)
  {
    let to = PixilSaga.GameController.configs.Contract.GetGameControllerContract();
    let resultCheckApprove = await PixilSaga.RobotNFT.getApproved (robotId);
    if (to == resultCheckApprove) {
      $(".btn-approve").hide();
      $(".btn-set-in-game").show();
    }
    else {
      $(".btn-approve").show();
      $(".btn-set-in-game").hide();
    }
  }
  function approve(robotId)
  {
    let to = PixilSaga.GameController.configs.Contract.GetGameControllerContract();
    PixilSaga.RobotNFT.approve(to, robotId);
  }

  function LetRobotNFTJoinToGame(heroId)
  {
    PixilSaga.GameController.LetRobotNFTJoinToGame(robotId);
  }
</script>

